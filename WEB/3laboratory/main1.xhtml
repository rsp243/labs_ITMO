
<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://java.sun.com/jsf/core" xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
    <meta charset="utf-8" />
    <title>Reshetov Semen P3206 WEB 2lab</title>
    <meta name="description" content="Reshetov Semen P3206 WEB 3lab" />
    <meta name="author" content="Reshetov Semen" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <h:outputStylesheet library="css" name="styles.css" />
</h:head>

<h:body>
    <header>
        <div class="introduction">
            <h3>Third web laboratory</h3>
            <strong>Reshetov Semen, P3206. Variant: 1805</strong>
        </div>
        <div class="links">
            <form action="https://se.ifmo.ru/courses/web" target="_blank">
                <button class="nav-button">
                    SE VITMO
                </button>
            </form>
            <form action="https://github.com/rsp243" target="_blank">
                <button class="nav-button">
                    Github account
                </button>
            </form>
            <form action="https://t.me/rsp243" target="_blank">
                <button class="nav-button">
                    Telegram account
                </button>
            </form>
        </div>
    </header>
    <div class="main-container">
        <h:form id="canvas_form">
            <h:inputHidden id="canvas_r" value="#{rBean.value}" validator="${rBean.validateR}" />
        </h:form>
        <div class="canvas-and-selection">
            <canvas id="canvas" width="300" height="300"></canvas>
            <div class="rValueSelectedInfo">
                Chosen R value - <div class="rValueSelected"></div>
            </div>
            <h:form action="controller" method="GET">
                <div class="params-selection">
                    <div class="Xselection">
                        <p>Choose X value</p>
                        <h:selectOneRadio value="#{xBean.x}">
                            <f:selectItem id="x_m5" itemValue="-5" itemLabel="-5" />
                            <f:selectItem id="x_m4" itemValue="-4" itemLabel="-4" />
                            <f:selectItem id="x_m3" itemValue="-3" itemLabel="-3" />
                            <f:selectItem id="x_m2" itemValue="-2" itemLabel="-2" />
                            <f:selectItem id="x_m1" itemValue="-1" itemLabel="-1" />
                            <f:selectItem id="x_0" itemValue="0" itemLabel="0" />
                            <f:selectItem id="x_1" itemValue="1" itemLabel="1" />
                            <f:selectItem id="x_2" itemValue="2" itemLabel="2" />
                            <f:selectItem id="x_3" itemValue="3" itemLabel="3" />
                        </h:selectOneRadio>
                    </div>
                    <div class="Yselection">
                        <p>Choose Y value</p>
                        <p class="Y-error-message error-message">Y value have to be float number between -3 and 5 (not
                            including)</p>
                        <h:inputText type="text" class="Yselection-text" id="Yselection" name="yVal"
                            a:placeholder="Y value" maxlength="15" required="true" value="${yBean.y}" validator="${yBean.validateY}" />
                    </div>
                    <div class="Rselection">
                        <p>Choose R value</p>
                        <p class="R-error-message error-message">R value have to be float number between 1 and 3
                            (including)
                        </p>
                        <div class="checkbox-block">
                            <h:commandButton id="r_b1" value="1" onclick="setRValue(this.value)" />
                            <h:commandButton id="r_b2" value="1.5" onclick="setRValue(this.value)" />
                            <h:commandButton id="r_b3" value="2" onclick="setRValue(this.value)" />
                            <h:commandButton id="r_b4" value="2.5" onclick="setRValue(this.value)" />
                            <h:commandButton id="r_b5" value="3" onclick="setRValue(this.value)" />
                        </div>
                    </div>
                </div>
                <div class="btn-block">
                    <div class="btn-main-block">
                        <h:commandButton class="control-btn btn-process" id="submit_button" value="Throw An Axe">
                            <f:ajax execute="@form" listener="#{checkAreaResultsBean.newResult(xBean.x,
                                yBean.y, rBean.value)}" render="@form resultsTable"/>
                        </h:commandButton>
                        <button class="control-btn btn-clear">Clear Table</button>
                    </div>
                    <h:button class="control-btn" value="Go To Watches Page" outcome="watches" />
                </div>
            </h:form>
        </div>
        <div class="data-table">
            <h:dataTable id="resultsTable" value="#{checkAreaResultsBean.results}" var="axe" cellspacing="1" cellpadding="10"
                width="100%">
                <h:column>
                    <f:facet name="header">X Value</f:facet>
                    #{axe.x}
                </h:column>

                <h:column>
                    <f:facet name="header">Y Value</f:facet>
                    #{axe.y}
                </h:column>

                <h:column>
                    <f:facet name="header">R Value</f:facet>
                    #{axe.r}
                </h:column>
                <h:column>
                    <f:facet name="header">Hit/Miss</f:facet>
                    #{axe.isResult()}
                </h:column>

                <h:column>
                    <f:facet name="header">Event time</f:facet>
                    #{axe.currenttime}
                </h:column>

                <h:column>
                    <f:facet name="header">Execution time, ns</f:facet>
                    #{axe.executiontime}
                </h:column>
            </h:dataTable>
        </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/2.0.0/moment.min.js"></script>
    <h:outputScript library="js" name="canvas.js" />
    <script type="text/javascript">

        function setRValue(commandButtonValue) {
            localStorage.setItem("rValue", commandButtonValue)
            document.getElementById("canvas_form:canvas_r").value = commandButtonValue;
            return commandButtonValue
        }

        function getRValue() {
            let rValue = parseFloat(localStorage.getItem("rValue"))
            if (!rValue) {
                rValue = "Not Selected"
            }
            $(".rValueSelected").text(rValue);
            return rValue
        }

        window.onload = function () {
            getRValue()
            drawBeginnigGraph()
            canvasClick()
        }

    </script>
</h:body>

</html>